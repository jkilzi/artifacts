{"version":3,"file":"queryBuilder.cjs.js","sources":["../../src/helpers/queryBuilder.ts"],"sourcesContent":["/*\n * Copyright 2024 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { Pagination } from '../types/pagination';\n\nexport function buildGraphQlQuery(args: {\n  type: 'ProcessDefinitions' | 'ProcessInstances' | 'Jobs';\n  queryBody: string;\n  whereClause?: string;\n  pagination?: Pagination;\n}): string {\n  let query = `{${args.type}`;\n\n  const whereClause = buildWhereClause(args.whereClause);\n  const paginationClause = buildPaginationClause(args.pagination);\n\n  if (whereClause || paginationClause) {\n    query += ' (';\n    query += [whereClause, paginationClause].filter(Boolean).join(', ');\n    query += ') ';\n  }\n\n  query += ` {${args.queryBody} } }`;\n\n  return query.replace(/\\s+/g, ' ').trim();\n}\n\nfunction buildWhereClause(whereClause?: string): string {\n  return whereClause ? `where: {${whereClause}}` : '';\n}\n\nfunction buildPaginationClause(pagination?: Pagination): string {\n  if (!pagination) return '';\n\n  const parts = [];\n\n  if (pagination.sortField !== undefined) {\n    parts.push(\n      `orderBy: {${pagination.sortField}: ${\n        pagination.order !== undefined ? pagination.order?.toUpperCase() : 'ASC'\n      }}`,\n    );\n  }\n\n  const paginationParts = [];\n  if (pagination.limit !== undefined) {\n    paginationParts.push(`limit: ${pagination.limit}`);\n  }\n  if (pagination.offset !== undefined) {\n    paginationParts.push(`offset: ${pagination.offset}`);\n  }\n  if (paginationParts.length) {\n    parts.push(`pagination: {${paginationParts.join(', ')}}`);\n  }\n\n  return parts.join(', ');\n}\n"],"names":[],"mappings":";;AAiBO,SAAS,kBAAkB,IAKvB,EAAA;AACT,EAAI,IAAA,KAAA,GAAQ,CAAI,CAAA,EAAA,IAAA,CAAK,IAAI,CAAA,CAAA,CAAA;AAEzB,EAAM,MAAA,WAAA,GAAc,gBAAiB,CAAA,IAAA,CAAK,WAAW,CAAA,CAAA;AACrD,EAAM,MAAA,gBAAA,GAAmB,qBAAsB,CAAA,IAAA,CAAK,UAAU,CAAA,CAAA;AAE9D,EAAA,IAAI,eAAe,gBAAkB,EAAA;AACnC,IAAS,KAAA,IAAA,IAAA,CAAA;AACT,IAAS,KAAA,IAAA,CAAC,aAAa,gBAAgB,CAAA,CAAE,OAAO,OAAO,CAAA,CAAE,KAAK,IAAI,CAAA,CAAA;AAClE,IAAS,KAAA,IAAA,IAAA,CAAA;AAAA,GACX;AAEA,EAAS,KAAA,IAAA,CAAA,EAAA,EAAK,KAAK,SAAS,CAAA,IAAA,CAAA,CAAA;AAE5B,EAAA,OAAO,KAAM,CAAA,OAAA,CAAQ,MAAQ,EAAA,GAAG,EAAE,IAAK,EAAA,CAAA;AACzC,CAAA;AAEA,SAAS,iBAAiB,WAA8B,EAAA;AACtD,EAAO,OAAA,WAAA,GAAc,CAAW,QAAA,EAAA,WAAW,CAAM,CAAA,CAAA,GAAA,EAAA,CAAA;AACnD,CAAA;AAEA,SAAS,sBAAsB,UAAiC,EAAA;AAC9D,EAAI,IAAA,CAAC,YAAmB,OAAA,EAAA,CAAA;AAExB,EAAA,MAAM,QAAQ,EAAC,CAAA;AAEf,EAAI,IAAA,UAAA,CAAW,cAAc,KAAW,CAAA,EAAA;AACtC,IAAM,KAAA,CAAA,IAAA;AAAA,MACJ,CAAA,UAAA,EAAa,UAAW,CAAA,SAAS,CAC/B,EAAA,EAAA,UAAA,CAAW,KAAU,KAAA,KAAA,CAAA,GAAY,UAAW,CAAA,KAAA,EAAO,WAAY,EAAA,GAAI,KACrE,CAAA,CAAA,CAAA;AAAA,KACF,CAAA;AAAA,GACF;AAEA,EAAA,MAAM,kBAAkB,EAAC,CAAA;AACzB,EAAI,IAAA,UAAA,CAAW,UAAU,KAAW,CAAA,EAAA;AAClC,IAAA,eAAA,CAAgB,IAAK,CAAA,CAAA,OAAA,EAAU,UAAW,CAAA,KAAK,CAAE,CAAA,CAAA,CAAA;AAAA,GACnD;AACA,EAAI,IAAA,UAAA,CAAW,WAAW,KAAW,CAAA,EAAA;AACnC,IAAA,eAAA,CAAgB,IAAK,CAAA,CAAA,QAAA,EAAW,UAAW,CAAA,MAAM,CAAE,CAAA,CAAA,CAAA;AAAA,GACrD;AACA,EAAA,IAAI,gBAAgB,MAAQ,EAAA;AAC1B,IAAA,KAAA,CAAM,KAAK,CAAgB,aAAA,EAAA,eAAA,CAAgB,IAAK,CAAA,IAAI,CAAC,CAAG,CAAA,CAAA,CAAA,CAAA;AAAA,GAC1D;AAEA,EAAO,OAAA,KAAA,CAAM,KAAK,IAAI,CAAA,CAAA;AACxB;;;;"}